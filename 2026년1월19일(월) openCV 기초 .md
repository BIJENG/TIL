# 📘 OpenCV 기초 및 이미지 데이터 처리 학습 (Day 1)

## 1. OpenCV란?
[cite_start]**OpenCV (Open Source Computer Vision Library)**는 컴퓨터가 이미지나 영상을 이해하고 처리할 수 있게 도와주는 오픈소스 라이브러리입니다[cite: 22].
인공지능(CNN)이 이미지를 보고 판단(분류)하는 '뇌'라면, OpenCV는 이미지를 자르고, 보정하고, 전처리하는 '눈과 손' 역할을 수행합니다.

### 🏥 헬스케어 분야 활용 예시
* **X-ray/MRI 전처리:** 노이즈 제거 및 명암비(Contrast) 조절
* **ROI 설정:** 종양이나 골절 의심 부위만 잘라내어 분석
* **시각화:** 진단 결과(텍스트)나 의심 영역(박스)을 의료 영상 위에 표시

---

## 2. 핵심 개념 정리

### ① 데이터 구조 (NumPy Array)
* [cite_start]OpenCV는 이미지를 **NumPy 배열(ndarray)**로 다룹니다[cite: 77, 85].
* **Shape:** `(Height, Width, Channels)` 순서입니다. (예: `(500, 500, 3)`)
* [cite_start]**Color Space (BGR):** 일반적인 RGB와 달리, OpenCV는 **Blue-Green-Red (BGR)** 순서로 색상을 읽습니다[cite: 97].
    * 빨간색 표현: `(0, 0, 255)` (O) / `(255, 0, 0)` (X)
* **Data Type (`uint8`):** 이미지 픽셀은 0~255 사이의 정수 값을 가지므로, 메모리 효율을 위해 `np.uint8` 타입을 사용합니다.

### ② 좌표계 (Coordinate System)
* 이미지의 **왼쪽 상단(Top-Left)**이 `(0, 0)`입니다.
* **x축:** 오른쪽으로 갈수록 증가
* **y축:** 아래쪽으로 갈수록 증가 (수학 그래프와 반대 방향 주의)

---

## 3. 주요 함수 및 기술 (Technical Stack)

### [cite_start]🖼️ 이미지 입출력 [cite: 102]
| 함수 | 설명 | 주의사항 |
| :--- | :--- | :--- |
| `cv2.imread(path)` | 이미지 파일 읽기 | 경로에 한글이 있으면 못 읽음 (None 반환) |
| `cv2.imshow(name, img)` | 화면에 이미지 표시 | 창 이름(name) 지정 필수 |
| `cv2.imwrite(path, img)` | 이미지를 파일로 저장 | 폴더가 없으면 에러 발생 (경로 확인 필수) |
| `cv2.waitKey(0)` | 키 입력 대기 | `0`은 무한 대기. 없으면 창이 바로 꺼짐 |
| `cv2.destroyAllWindows()` | 모든 창 닫기 | 메모리 누수 방지 |

### [cite_start]✍️ 텍스트 및 도형 그리기 [cite: 184, 190]
이미지 위에 정보를 시각화(Annotation)할 때 사용합니다. 의료 데이터의 진단명 표기에 필수적입니다.

```python
cv2.putText(img, text, org, font, fontScale, color, thickness)
```
- img: 대상 이미지 (NumPy 배열)
- text: 출력할 문자열 (영어만 가능, 한글 깨짐)
- org: 텍스트 시작 좌표 (x, y) (왼쪽 하단 기준)
- color: BGR 튜플 (B, G, R)

---

## 4. 실습 과제 및 해결 과정 (Practice)
### 과제 1: 하늘색 배경 만들고 텍스트 쓰기
기술 포인트: np.zeros(검은색) 대신 np.full을 사용하여 특정 색상 배경 생성

```Python

import cv2
import numpy as np

# 1. 하늘색(Sky Blue) 배경 생성 (BGR: 235, 206, 135)
# np.full((높이, 너비, 채널), 색상값, 타입)
new_image = np.full((500, 500, 3), (235, 206, 135), dtype=np.uint8)

# 2. 텍스트 출력
cv2.putText(new_image, "OpenCV Text Practice", (80, 50), 
            cv2.FONT_HERSHEY_TRIPLEX, 1, (0, 0, 255), 2)

cv2.imshow('Result', new_image)
cv2.waitKey(0)
cv2.destroyAllWindows()
```
### 과제 2: 이미지 불러오기 및 설명글 달기 (멀티라인 처리)
기술 포인트: 1. os.path.exists로 파일 존재 여부 확인 (예외 처리) 2. OpenCV의 줄바꿈(\n) 미지원 해결을 위한 좌표(Coordinate) 계산

```Python

import cv2
import os

file_path = './images/messi.jpg'

if os.path.exists(file_path):
    img = cv2.imread(file_path)
    
    # 첫 번째 줄
    cv2.putText(img, "Lionel Messi", (30, 350), 
                cv2.FONT_HERSHEY_DUPLEX, 1, (255, 255, 255), 2)
    
    # 두 번째 줄 (y좌표를 45픽셀 내려서 출력)
    # OpenCV는 '\n'을 인식하지 못하므로 직접 좌표를 수정해야 함
    cv2.putText(img, "The Legendary Player", (30, 350 + 45), 
                cv2.FONT_HERSHEY_DUPLEX, 1, (255, 255, 255), 2)
                
    cv2.imshow('Messi', img)
    cv2.waitKey(0)
    cv2.destroyAllWindows()
else:
    print("파일이 없습니다.")
```

---

## 5. 트러블 슈팅 (Troubleshooting)
1. 배경색 오류: np.zeros는 0으로 채우므로 무조건 검은색이 됨.
 - 👉 해결: np.full 사용 또는 img[:] = (B,G,R)로 색상 채우기.

2. 한글 출력 불가: OpenCV는 한글을 지원하지 않음 (???로 출력됨).
 - 👉 해결: 영문으로 작성하거나, Pillow(PIL) 라이브러리로 변환하여 출력 후 다시 OpenCV로 변환하는 방법 사용.

3. 경로 문제: 윈도우 환경에서 상대 경로(./) 사용 시, 실행 위치에 따라 파일을 못 찾을 수 있음.
 - 👉 해결: os.path.exists()로 파일 존재 여부를 먼저 체크하는 방어 코드 작성.
