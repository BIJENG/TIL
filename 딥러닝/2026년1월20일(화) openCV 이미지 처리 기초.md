# 📂 AI 헬스케어 & OpenCV 학습 노트 (Day 1)

## 1. OpenCV 이미지 처리 기초

### 💡 핵심 포인트: 데이터 타입과 오버플로우 방지
이미지 연산 시 `uint8`(0~255) 타입끼리 더하면 255를 넘을 때 숫자가 깨지는 **오버플로우(Overflow)** 현상이 발생합니다. 이를 방지하기 위해 더 큰 그릇인 `uint16`으로 변환 후 계산해야 합니다.

```python
import cv2
import numpy as np

# ❌ 잘못된 예 (200 + 100 = 300이 아니라 44가 됨)
# gray = (b + g + r) / 3 

# ✅ 올바른 예 (형변환 후 계산)
# 1. b를 uint16으로 변환하여 더 큰 수를 담을 공간 확보
# 2. 계산이 끝난 후 다시 uint8로 변환하여 이미지 포맷 맞춤
gray = ((b.astype(np.uint16) + g + r) / 3).astype(np.uint8)
```

---

### 🎨 컬러 스플래시 (Color Splash) 구현
특정 색상만 남기고 나머지는 흑백으로 만드는 기법입니다. if문 대신 마스크(Mask) 연산을 사용해야 픽셀 단위 처리가 가능합니다.
- 마스크(Mask): 원하는 영역은 255(흰색), 원치 않는 영역은 0(검은색)으로 표시한 지도.
- np.where: 조건에 따라 값을 선택하는 함수.

```python
# 1. 빨간색이 진한 영역(ROI) 추출 (Mask 생성)
mask = np.where(r > 150, 255, 0).astype(np.uint8)

# 2. 마스크를 이용한 합성
# mask가 255인 곳은 원본(r)을 쓰고, 아니면 흑백(gray)을 씀
new_r = np.where(mask == 255, r, gray)
new_g = np.where(mask == 255, g, gray) # 배경은 흑백
new_b = np.where(mask == 255, b, gray) # 배경은 흑백

# 3. 채널 합치기
color_splash = cv2.merge([new_b, new_g, new_r])
```

---

## 2. 딥러닝 기초: 윤년 판별 모델
### 🏗️ 데이터 전처리 (Feature Engineering)
단순히 연도 숫자(예: 2024)를 넣는 것보다, **규칙의 핵심(나머지 연산)**을 추출해서 넣어주는 것이 학습 효율과 정확도를 높입니다.

Bad Input: [2024]
 - 숫자가 너무 크고, 학습 범위(1~2000)를 벗어나면 예측 불가 (외삽 문제 발생).

Good Input: [2024%4, 2024%100, 2024%400] -> [0, 24, 24]
 - 연도가 아무리 커져도 입력값은 항상 일정 범위 내에 있음.
 - 모델이 AND, OR 논리를 스스로 학습하기 최적화된 형태.

### 🔄 학습(Train)과 추론(Inference)의 일치 (Pipeline)
모델을 학습시킬 때 사용한 데이터 형태와, 실제 예측할 때 넣어주는 데이터 형태는 반드시 같아야 합니다.

```python
# 1. 학습 데이터 (X)
# [[1, 1, 1], [2, 2, 2], ... [0, 0, 0]] 형태의 3열 데이터로 구성
X_data = []
for y in years:
    X_data.append([y % 4, y % 100, y % 400])

# 2. 모델 구조
# 입력 개수가 3개이므로 input_dim=3 설정
self.fc1 = nn.Linear(3, 16)

# 3. 추론(테스트) 함수
def predict_leap_year(year):
    model.eval()
    with torch.no_grad():
        # ★중요★ 테스트할 때도 학습 때와 똑같이 3개의 특징을 만들어야 함
        features = [year % 4, year % 100, year % 400] 
        input_tensor = torch.tensor([features], dtype=torch.float32)
        
        output = model(input_tensor)
        return output.item() >= 0.5
```

---

## 3. 핵심 개념 Q&A
### Q1. reshape(-1, 1)은 왜 필요한가?
이유: 딥러닝 모델(PyTorch/TensorFlow)은 데이터를 항상 행렬(Matrix) 형태로 받기를 원하기 때문입니다.
변환: 1차원 리스트 [1, 2, 3] ➡️ 2차원 행렬 [[1], [2], [3]] (N행 1열)

### Q2. 특징 3개를 넣으면 모델이 어떻게 판단하나? (AND 연산?)
우리가 if문을 써서 AND를 가르쳐주지 않아도 됩니다.
모델은 학습 과정에서 **"첫 번째 숫자(4배수)가 0이고, 두 번째(100배수)가 0이 아니면 윤년이다"**라는 가중치(Weight) 조합을 스스로 찾아냅니다.

## 4. 환경 설정 트러블 슈팅
Pandas 설치 에러: pip install pandas만 하면 pytz, dateutil 등의 부품이 없어 에러가 날 수 있음.
해결: pip install pytz python-dateutil 명령어로 수동 설치.
